@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    scroll-behavior: smooth;
  }
  
  body {
    @apply bg-dark-950 text-white font-sans;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
  }
  
  h1, h2, h3, h4, h5, h6 {
    @apply font-display font-medium;
  }
}

@layer components {
  .container {
    @apply px-4 mx-auto max-w-7xl;
  }
  
  .gradient-text {
    @apply text-transparent bg-clip-text bg-gradient-to-r from-primary-400 to-accent-400;
  }
  
  .gradient-border {
    position: relative;
  }
  
  .gradient-border::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(to right, theme('colors.primary.400'), theme('colors.accent.400'));
    -webkit-mask: 
      linear-gradient(#fff 0 0) content-box, 
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }
  
  .neon-glow {
    text-shadow: 0 0 8px theme('colors.primary.400'), 0 0 16px rgba(131, 52, 255, 0.3);
  }
  
  .card-hover {
    @apply transition-all duration-300 hover:shadow-[0_0_25px_rgba(154,103,255,0.15)] hover:-translate-y-1;
  }
  
  .tech-icon {
    @apply grayscale opacity-60 transition duration-300 hover:grayscale-0 hover:opacity-100;
  }

  /* Animated background grid line */
  .animated-grid-line {
    background: linear-gradient(90deg, 
      transparent 0%, 
      theme('colors.primary.400/20') 50%,
      transparent 100%
    );
    background-size: 200% 100%;
    animation: shimmer 8s infinite;
  }

  @keyframes shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }
}

@layer utilities {
  /*
    Background gradient image layer
    - Use CSS var --bg-image to customize the image URL
    - Defaults to '/img/background/gradients-v2.png'
  */
  .site-gradient-bg {
    /* Only image background, no fallback */
    background-image: var(--bg-image, url('/generated-image (1).png'));
    background-color: #000000;
    background-attachment: fixed;
    background-size: var(--bg-size, contain);
    background-repeat: no-repeat;
    background-position: center var(--bg-y, bottom);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    perspective: 1000px;
    will-change: transform;
  }

  /* Ensure background aligns consistently across devices */
  @media (max-width: 1024px) {
    .site-gradient-bg {
      /* iPad/tablet: crop more to avoid showing full image */
      background-attachment: scroll; /* iOS Safari fix */
      background-size: 200% auto; /* stronger zoom for parity with desktop */
      background-position: center -10%;
    }
  }

  @media (max-width: 640px) {
    .site-gradient-bg {
      background-attachment: scroll; /* iOS Safari fix */
      background-size: 260% auto; /* strongest zoom on phones */
      background-position: center -30%;
    }
  }

  /* Optional: flip background vertically when needed */
  .bg-flip-y {
    transform: scaleY(-1);
    transform-origin: center;
    will-change: transform;
  }

  /*
    Mask utilities (Chrome + Firefox):
    - Customize stops with CSS vars
      --mask-c1 (start color), --mask-c2 (mid color), --mask-c3 (end color)
      Defaults: transparent -> black -> black
    - Direction variants available
  */
  .mask-vars {
    --mask-c1: transparent;
    --mask-c2: black;
    --mask-c3: black;
  }

  /* Vertical bottom fade (top transparent -> bottom opaque) */
  .mask-fade-b {
    -webkit-mask: linear-gradient(to bottom, var(--mask-c1) 0%, var(--mask-c2) 5%, var(--mask-c3) 100%);
    mask: linear-gradient(to bottom, var(--mask-c1) 0%, var(--mask-c2) 5%, var(--mask-c3) 100%);
  }

  /* Vertical top fade (bottom transparent) */
  .mask-fade-t {
    -webkit-mask: linear-gradient(to top, var(--mask-c1) 0%, var(--mask-c2) 5%, var(--mask-c3) 100%);
    mask: linear-gradient(to top, var(--mask-c1) 0%, var(--mask-c2) 5%, var(--mask-c3) 100%);
  }

  /* Horizontal left-to-right fade */
  .mask-fade-r {
    -webkit-mask: linear-gradient(to right, var(--mask-c1) 0%, var(--mask-c2) 5%, var(--mask-c3) 100%);
    mask: linear-gradient(to right, var(--mask-c1) 0%, var(--mask-c2) 5%, var(--mask-c3) 100%);
  }

  /* Horizontal right-to-left fade */
  .mask-fade-l {
    -webkit-mask: linear-gradient(to left, var(--mask-c1) 0%, var(--mask-c2) 5%, var(--mask-c3) 100%);
    mask: linear-gradient(to left, var(--mask-c1) 0%, var(--mask-c2) 5%, var(--mask-c3) 100%);
  }

  /* Diagonal fade (top-left to bottom-right) */
  .mask-fade-diag {
    -webkit-mask: linear-gradient(45deg, var(--mask-c1) 0%, var(--mask-c2) 20%, var(--mask-c3) 80%);
    mask: linear-gradient(45deg, var(--mask-c1) 0%, var(--mask-c2) 20%, var(--mask-c3) 80%);
  }

  /* GPU rendering hint (optional) */
  .gpu-hint {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    perspective: 1000px;
    will-change: transform;
  }
}

/* Pulse animation */
@keyframes pulse {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

.animate-pulse-slow {
  animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* Floating animation */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

/* Add gradient animation */
@keyframes gradientAnimation {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.animated-gradient {
  background-size: 200% 200%;
  animation: gradientAnimation 15s ease infinite;
}

/* Custom scrollbar styles */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: #4a5568 transparent;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background-color: #4a5568;
  border-radius: 3px;
  transition: background-color 0.2s ease;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #6b7280;
}

/* Improve mobile modal scroll performance and prevent lock */
.modal-scroll {
  -webkit-overflow-scrolling: touch; /* momentum scrolling on iOS */
  overscroll-behavior: contain; /* prevent body scroll chaining */
  contain: layout style paint; /* isolate for performance */
  backface-visibility: hidden;
  transform: translateZ(0);
}

/* Prevent body scroll when modal is open, but allow modal content to scroll */
body.modal-open {
  overflow: hidden;
  position: fixed;
  width: 100%;
}

/* Force white calendar icon in dark inputs */
.date-picker-white::-webkit-calendar-picker-indicator {
  filter: invert(1) brightness(1.2);
  cursor: pointer;
}

  /* Mobile modal improvements */
  @media (max-width: 640px) {
    /* Prevent zoom on all inputs */
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="date"],
    input[type="time"],
    textarea,
    select {
      font-size: 16px !important;
    }
    
    /* Larger, touch-friendly fields in modals */
    .modal-content input,
    .modal-content select,
    .modal-content textarea {
      height: 44px !important;
      min-height: 44px !important;
      max-height: none !important;
      font-size: 16px !important;
      padding: 10px 12px !important;
      line-height: 1.2 !important;
      box-sizing: border-box !important;
      border-radius: 10px !important;
    }
  
  /* Specific overrides for date inputs */
  .modal-content input[type="date"] {
    height: 44px !important;
    min-height: 44px !important;
    max-height: none !important;
    font-size: 16px !important;
    padding: 10px 12px !important;
    line-height: 1.2 !important;
    box-sizing: border-box !important;
    color: #ffffff !important;
    -webkit-text-fill-color: #ffffff !important; /* iOS Safari */
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
  }

  /* Placeholder styling for select (e.g., "Selecione um hor√°rio") */
  .modal-content select:invalid {
    color: #9ca3af !important; /* text-gray-400 */
  }
  .modal-content select option[disabled][value=""] {
    color: #9ca3af !important; /* ensure placeholder option stays gray */
  }
  
  /* Override browser default date input styling */
  input[type="date"]::-webkit-calendar-picker-indicator {
    height: 16px !important;
    width: 16px !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  /* Ensure date input container doesn't add extra height */
  .modal-content input[type="date"]::-webkit-datetime-edit {
    padding: 6px 0 !important;
    margin: 0 !important;
    height: 28px !important;
    line-height: 28px !important;
    color: #ffffff !important;
  }
  
  .modal-content input[type="date"]::-webkit-datetime-edit-fields-wrapper {
    padding: 0 !important;
    margin: 0 !important;
  }
  
  .modal-content input[type="date"]::-webkit-datetime-edit-text {
    padding: 0 4px !important;
    margin: 0 !important;
    color: #ffffff !important;
  }
  
  .modal-content input[type="date"]::-webkit-datetime-edit-month-field,
  .modal-content input[type="date"]::-webkit-datetime-edit-day-field,
  .modal-content input[type="date"]::-webkit-datetime-edit-year-field {
    padding: 0 !important;
    margin: 0 !important;
    color: #ffffff !important;
  }
  
  /* Specific class for mobile date input */
  .mobile-date-input {
    height: 28px !important;
    min-height: 28px !important;
    max-height: 28px !important;
    font-size: 12px !important;
    padding: 2px 6px !important;
    line-height: 1.2 !important;
    box-sizing: border-box !important;
  }
  
  /* Improve modal spacing on mobile */
  .modal-mobile-spacing {
    padding-top: 1rem;
    padding-bottom: 1rem;
  }
  
  /* Better touch targets for mobile */
  .mobile-touch-target {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Prevent body scroll when modal is open */
  body.modal-open {
    overflow: hidden;
    position: fixed;
    width: 100%;
  }
  
  /* Ensure modal content can still scroll */
  .modal-content {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
  
  /* Fix chat layout on mobile */
  .chat-container {
    display: flex !important;
    flex-direction: column !important;
    height: 100vh !important;
    max-height: 100vh !important;
    width: 100vw !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    overflow: hidden !important;
    z-index: 20 !important;
    box-sizing: border-box !important;
  }
  
  /* Ensure input is always visible */
  .chat-container .chat-input {
    flex-shrink: 0 !important;
    position: relative !important;
    bottom: 0 !important;
    z-index: 30 !important;
    background: #0f172a !important;
    border-top: 1px solid #334155 !important;
    min-height: 80px !important;
    max-height: 120px !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    box-sizing: border-box !important;
    width: 100% !important;
  }
  
  .chat-header {
    flex-shrink: 0;
    position: sticky;
    top: 0;
    z-index: 20;
  }
  
  .chat-messages {
    flex: 1 !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    padding-bottom: 1rem !important;
    min-height: 0 !important;
    max-height: calc(100vh - 200px) !important;
    box-sizing: border-box !important;
  }
  
  
  /* Ensure only one view is visible on mobile */
  .chat-container.hidden,
  .flow-container.hidden {
    display: none !important;
  }
  
  /* Fix flow layout on mobile */
  .flow-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    max-height: 100vh;
    width: 100vw;
    position: fixed;
    top: 0;
    left: 0;
    overflow: hidden;
    z-index: 25;
  }
  
  .flow-header {
    flex-shrink: 0;
    position: sticky;
    top: 0;
    z-index: 30;
    background: #0f172a;
    border-bottom: 1px solid #334155;
    padding: 1rem;
  }
  
  .flow-canvas {
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    min-height: 0;
    position: relative;
  }
  
  /* Fix zoom buttons positioning on mobile */
  .flow-canvas [data-export-ignore="true"] {
    position: fixed !important;
    top: 80px !important;
    left: 20px !important;
    z-index: 40 !important;
  }
  
  /* Ensure ChatInput is visible on mobile */
  .chat-container .chat-input input {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    height: 40px !important;
    min-height: 40px !important;
    width: 100% !important;
    box-sizing: border-box !important;
  }
  
  .chat-container .chat-input button {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  /* Ensure input stays within viewport */
  .chat-container {
    max-height: 100vh !important;
    max-height: 100dvh !important; /* Dynamic viewport height for mobile */
  }
  
  .chat-container .chat-input {
    position: sticky !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
  }
  
  /* Additional mobile flow fixes */
  /* keep .flow-container fullscreen fixed as defined above */
  
  /* No mobile overrides for zoom buttons - let inline styles handle it */
  
  /* Improve touch experience for flow canvas */
  .flow-canvas svg {
    touch-action: none !important;
    -webkit-touch-callout: none !important;
    -webkit-user-select: none !important;
    -khtml-user-select: none !important;
    -moz-user-select: none !important;
    -ms-user-select: none !important;
    user-select: none !important;
  }
  
  /* Mobile flow canvas optimizations */
  .flow-canvas {
    background: #f1f5f9 !important;
    min-height: 400px !important;
  }
  
  /* Better node visibility on mobile */
  .flow-canvas foreignObject {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)) !important;
  }
  
  /* Improve text readability in nodes */
  .flow-canvas foreignObject div {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
  }
  
  /* Smooth zoom transitions */
  .flow-canvas svg {
    transition: transform 0.1s ease-out !important;
  }
  
  /* Fix chat input send button alignment on mobile */
  .chat-container .chat-input button {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
  
  .chat-container .chat-input button svg {
    margin: 0 !important;
    padding: 0 !important;
    transform: none !important;
  }
  
  /* Simple mobile improvements for PDF and Consultation buttons */
  .flow-container .absolute.bottom-20 {
    bottom: 20px !important;
    left: 16px !important;
    right: 16px !important;
    transform: none !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    z-index: 50 !important;
    max-width: calc(100vw - 32px) !important;
    width: auto !important;
    position: fixed !important;
  }
  
  .flow-container .absolute.bottom-20 button {
    min-height: 44px !important;
    font-size: 14px !important;
    padding: 12px 16px !important;
    width: 100% !important;
    box-sizing: border-box !important;
    flex: 1 !important;
  }
}

/* Infinite scroll animation */
@keyframes scroll {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-50%);
  }
}

.animate-scroll {
  animation: scroll 40s linear infinite;
  will-change: transform;
}

/* Prevent iOS Safari auto-zoom on inputs by ensuring 16px font-size */
@supports (-webkit-touch-callout: none) {
  input,
  select,
  textarea {
    font-size: 16px !important;
  }
  .chat-container .chat-input input {
    font-size: 16px !important;
  }
  /* Modal inputs specifically */
  .modal-content input,
  .modal-content textarea,
  .modal-content select {
    font-size: 16px !important;
  }
  /* SchedulingModal inputs */
  [data-modal="scheduling"] input,
  [data-modal="scheduling"] textarea,
  [data-modal="scheduling"] select {
    font-size: 16px !important;
  }
  /* LeadForm inputs */
  [data-modal="lead"] input,
  [data-modal="lead"] textarea,
  [data-modal="lead"] select {
    font-size: 16px !important;
  }
}